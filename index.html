<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¸Šäº†å¤§å­¦å°±å¥½äº†ï¼šæ–°æ—¶ä»£å­¦ç”Ÿæ¨¡æ‹Ÿå™¨</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./style_of_panel.css">
    <script src="./render.js"></script>
    <script src="./openevents.js"></script>
    <script src="./panel_report.js"></script>
    <script src="./func.js"></script>
    <script src="./events.js"></script>
</head>
<body>
    <h1 style="text-align: center; color: white; margin: 15px 0; font-size: 22px;">ğŸ“š ä¸Šäº†å¤§å­¦å°±å¥½äº†ï¼šæ–°æ—¶ä»£å­¦ç”Ÿæ¨¡æ‹Ÿå™¨</h1>
    
    <!-- é¡¶éƒ¨ä¿¡æ¯æ  -->
    <div id="info-bar">
        <div class="info-card name-card">
            <span class="info-label">ğŸ‘¤ å§“å</span>
            <span class="info-value" id="name-display">æ— åæ°</span>
        </div>
        <div class="info-card gender-card">
            <span class="info-label">ğŸ¨ æ€§åˆ«</span>
            <span class="info-value" id="gender-display">ç”·</span>
        </div>
        <div class="info-card age-card">
            <span class="info-label">ğŸ‚ å¹´é¾„</span>
            <span class="info-value" id="age-display">18å²</span>
        </div>
        <div class="info-card season-card">
            <span class="info-label">ğŸƒ å­£èŠ‚</span>
            <span class="info-value" id="season-display">æ˜¥å­£</span>
        </div>
        <div class="info-card school-card">
            <span class="info-label">ğŸ« å­¦æ ¡</span>
            <span class="info-value" id="school-display">xxå®éªŒä¸­å­¦</span>
        </div>
        <div class="info-card major-card">
            <span class="info-label">ğŸ“ ä¸“ä¸š</span>
            <span class="info-value" id="major-display">ç†ç§‘</span>
        </div>
        <div class="info-card money-card">
            <span class="info-label">ğŸ’µ ç»æµ</span>
            <span class="info-value" id="money-display">0å…ƒ</span>
        </div>
    </div>
    
      <!-- ä¸»å†…å®¹åŒºï¼ˆå·¦å³åˆ†æ ï¼‰ -->
    <div id="main-content">
        <!-- å·¦ä¾§ï¼šèƒ½åŠ›å‚æ•° -->
        <div id="attributes-panel">
            <h3>ğŸ“ å±æ€§</h3>
            <div id="attributes-list"></div>
        </div>
      <!-- å³ä¾§ï¼šäº‹ä»¶ -->
        <div id="events-panel">
            <h3>ğŸ“… æœ¬å­£åº¦äº‹ä»¶</h3>
            <div id="events-list"></div>
        </div>
    </div>
    
   <!-- æŠ¥å‘Šæ  -->
    <div id="report-panel">
        <h3>ğŸ“¢ æŠ¥å‘Š</h3>
        <div id="report-content">ç°åœ¨æ˜¯é«˜ä¸‰ä¸‹å­¦æœŸï¼Œåœ¨è¿™ä¸ªæ˜¥å¤©ï¼Œé‡æ–°ä¹¦å†™ä½ çš„æ•…äº‹å§ï¼</div>
    </div>
    
    <!-- è¡ŒåŠ¨æ  -->
    <div id="actions-bar">
        <button class="action-btn" onclick="openStudyPanel()">ğŸ“– å­¦ä¹ /å·¥ä½œ</button>
        <button class="action-btn" onclick="openSocialPanel()">ğŸ‰ ç¤¾äº¤/å¨±ä¹</button>
        <button class="action-btn" onclick="openOtherPanel()">âš¡ å…¶ä»–è¡ŒåŠ¨</button>
        <button class="action-btn" onclick="openOptionPanel()">ğŸšï¸ ç³»ç»Ÿé€‰é¡¹</button>
        <button class="action-btn primary" onclick="nextSeason()">ğŸƒ ä¸‹ä¸€å­£åº¦</button>
    </div>


      <!-- æ¸¸æˆå¼€å§‹ / èµ·åå¼¹çª— -->
    <div id="start-modal">
        <div class="start-modal-content">
            <h2>ğŸ“ åºç«  é«˜è€ƒç¯‡</h2>
            <p class="start-intro";style="font-size: 14px; text-indent: 2em; ">
                <strong>ğŸ«çå¼€åŒçœ¼ï¼Œä½ åˆå›åˆ°äº†é«˜ä¸‰çš„æ•™å®¤é‡Œï¼Œå‘¨å›´çš„ä¸€åˆ‡éƒ½çœŸå®çš„è®©ä½ éš¾ä»¥æƒ³è±¡ã€‚</strong>
            </p>
            <p class="start-intro";style="font-size: 14px; text-indent: 2em">
                <strong>ğŸ‘¨â€ğŸ”§è¿™ä¸€æ¬¡ï¼Œä½ ä¼šèµ°å‘ä»€ä¹ˆæ ·çš„äººç”Ÿå‘¢ï¼Œæ˜¯ä¼šè¯»ç ”è¯»åšï¼Œèµ°å‘å­¦æœ¯ç§‘ç ”é¢ å³°ï¼Ÿè¿˜æ˜¯è€ƒå…¬è€ƒç¼–ï¼Œå¯»æ‰¾ä¸ªç¨³å®šçš„å·¥ä½œï¼ŸæŠ‘æˆ–æ˜¯å»èµšæ›´å¤šçš„é’±ï¼Œè¿‡ä¸Šå¯Œè£•çš„ç”Ÿæ´»ï¼Ÿ</strong>
            </p>
            <p class="start-intro";style="font-size: 14px; text-indent: 2em">
                <strong> ğŸ˜¶ä½†ä¹Ÿè¦å°å¿ƒï¼Œæ— è®ºæ˜¯è¯»ä¹¦è¿˜æ˜¯å·¥ä½œï¼Œéƒ½ä¸æ˜¯é‚£ä¹ˆè½»æ¾çš„ã€‚åœ¨è¿™ä¸ªå¹´ä»£ï¼Œæˆ‘ä»¬è¿™ä»£äººï¼Œåšä»€ä¹ˆéƒ½æ˜¯åƒå†›ä¸‡é©¬è¿‡ç‹¬æœ¨æ¡¥...</strong>
            </p>
            <p class="start-intro";style="font-size: 13px; text-indent: 2em;font-style: italic;">
                é€šè¿‡åº”å¯¹å„ç§ <strong>å­¦ä¹ </strong>ã€<strong>ç¤¾äº¤</strong>ã€
                <strong>å¨±ä¹</strong> ä¸ <strong>éšæœº</strong> äº‹ä»¶ï¼Œé€æ­¥å½±å“è‡ªå·±çš„èƒ½åŠ›å‚æ•°ï¼Œä½ çš„æ¯ä¸€ä¸ªé€‰æ‹©éƒ½ä¼šå½±å“ä½ çš„äººç”Ÿã€‚
            </p>
                
            </p>
            <ul class="start-features" style="font-style: italic;">
                <li>ğŸ“š æå‡æ™ºå•†ã€æƒ…å•†ã€é€»è¾‘ã€å·¥ç¨‹ç­‰å¤šç§èƒ½åŠ›å±æ€§</li>
                <li>ğŸ“… è§¦å‘å›ºå®šå‰§æƒ…äº‹ä»¶ä¸éšæœºæ—¥å¸¸äº‹ä»¶ï¼Œå½±å“å±æ€§å’Œç»“å±€</li>
                <li>ğŸ’­ æ¯ä¸€æ¬¡é€‰æ‹©éƒ½ä¼šæ”¹å˜ä½ çš„æˆé•¿è½¨è¿¹å’Œæœªæ¥äººç”Ÿ</li>
            </ul>
          <p class="start-intro" style="font-size: 14px; ">
            <strong>â€œç‹å°æ˜ï¼è€å¸ˆå«ä½ å‘¢â€æ—è¾¹çš„åŒæ¡Œæ€¼äº†æ€¼ä½ ã€‚</strong>
          </p>
          <p class="start-intro" style="font-size: 14px; ">
            <strong> å“¦å¯¹ï¼Œä½ çªç„¶æƒ³èµ·æ¥ï¼ä½ çš„åå­—æ˜¯ï¼š</strong>
          </p>
                
            <div class="start-name-block">
                <label for="player-name-input"></label>
                <input 
                    id="player-name-input" 
                    type="text" 
                    maxlength="8" 
                    placeholder="é»˜è®¤ä¸ºï¼šç‹å°æ˜ï¼ˆç”·ï¼‰ç‹å°ç¾ï¼ˆå¥³ï¼‰"
                >
            </div>

            <button class="start-confirm-btn" onclick="confirmStartGame()">
                âœ… å¼€å§‹æˆ‘çš„æ–°äººç”Ÿ
            </button>
        </div>
    </div>

    <!-- ç¬¬ä¸€ç«  ç« èŠ‚å¼¹çª—ï¼šè¿›å…¥å¤§å­¦ç¯‡ -->
    <div id="chapter-modal">
      <div class="chapter-content">
        <span class="close-modal" onclick="closeChapterModal()">&times;</span>
        <h2>ğŸ“ ç¬¬ä¸€ç«  æˆ‘çš„å¤§å­¦</h2>
        <p class="chapter-offer" id="chapter-offer" style="margin:8px 0 10px; font-size:18px; color:#333;">
          å·²å½•å–ï¼š<strong id="chapter-uni">â€”</strong>
          <span id="chapter-major-wrap" style="display:none;"> Â· <span id="chapter-major"></span></span>
        </p>

        <p class="chapter-intro"style="font-size: 13px; text-indent: 2em;font-style: italic;">
          é«˜è€ƒå·²ç»ç»“æŸï¼Œå¤§å­¦ç”Ÿæ´»å³å°†å¼€å§‹ã€‚
          ä½ å°†è¿æ¥å…¨æ–°çš„æ ¡å›­ã€åŒå­¦ä¸æŒ‘æˆ˜ï¼š
          ç ”ç©¶å­¦ä¹ ã€ç¤¾å›¢ç«èµ›ã€å®éªŒå®¤ã€å¯¼å¸ˆã€å®ä¹ ä¸æ±‚èŒâ€¦â€¦
        </p>
        <ul class="chapter-points">
          <li>è§£é”å¤§å­¦/ç ”ç©¶ç”Ÿ/åˆèŒåœºç›¸å…³äº‹ä»¶</li>
          <li>ç»“è¯†æ–° NPCï¼ˆå®¤å‹ã€è¾…å¯¼å‘˜ã€å¯¼å¸ˆã€å­¦é•¿/å­¦å§â€¦ï¼‰</li>
          <li>å¼€å¯ä¸“ä¸šæ–¹å‘ã€ç§‘ç ”è·¯çº¿ä¸å®ä¹ æœºä¼š</li>
        </ul>
        <div class="chapter-actions">
          <button class="chapter-btn primary" onclick="confirmEnterCollege()">ç«‹å³å¼€å¯å¤§å­¦ç¯‡</button>
          <button class="chapter-btn" onclick="closeChapterModal()">ç¨åå†çœ‹</button>
        </div>
      </div>
    </div>



    <!-- äº‹ä»¶è¯¦æƒ…å¼¹çª— -->
    <div id="event-modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeEventModal()">&times;</span>
            <h2 id="event-modal-title"></h2>
            <div id="event-modal-body"></div>
        </div>
    </div>

    <!-- æˆç»©å¼¹çª— -->
    <div id="scores-modal">
        <div class="scores-content">
            <span class="close-modal" onclick="closeScoresModal()">&times;</span>
            <h2>ğŸ“Š è€ƒè¯•æˆç»©</h2>
            <div id="scores-list"></div>
        </div>
    </div>

    <!-- å­¦ä¹ /å·¥ä½œå¼¹çª— -->
    <div id="study-modal">
      <div class="study-content">
        <span class="close-modal" onclick="closeStudyModal()">&times;</span>
        <h2>ğŸ“– å­¦ä¹  / å·¥ä½œé¢æ¿</h2>
        <div id="study-actions">
          <!-- æŒ‰é’®ä¼šåœ¨ JS ä¸­æ’å…¥ -->
        </div>
      </div>
    </div>

    <!-- ç¤¾äº¤/å¨±ä¹å¼¹çª— -->
    <div id="social-modal">
      <div class="social-content">
        <span class="close-modal" onclick="closeSocialModal()">&times;</span>
        <h2>ğŸ‰ ç¤¾äº¤ / å¨±ä¹</h2>
        <div id="social-actions"></div>
      </div>
    </div>

    <!-- å…¶ä»–è¡ŒåŠ¨å¼¹çª— -->
    <div id="other-modal">
      <div class="panel-content">
        <span class="close-modal" onclick="closeOtherPanel()">&times;</span>
        <h2>âš™ï¸ å…¶ä»–è¡ŒåŠ¨</h2>
        <p class="panel-tip">é€‰æ‹©ä½ è¦è¿›è¡Œçš„æ“ä½œï¼š</p>

        <div class="panel-grid" id="other-actions-box">
          <!-- JS åŠ¨æ€æ’å…¥æŒ‰é’® -->
        </div>
      </div>
    </div>


    <!-- å¾®ä¿¡è”ç³»äººå¼¹çª— -->
    <div id="wechat-modal">
      <div class="wechat-content">
        <span class="close-modal" onclick="closeWeChatModal()">&times;</span>
        <h2>ğŸŸ¢ å¾®ä¿¡</h2>
        <div id="wechat-list"></div>
      </div>


    <!-- å•†åº—å¼¹çª—ï¼šæ ¡é—¨å£çš„è¶…å¸‚ -->
    <div id="shop-modal">
      <div class="shop-content">
        <span class="close-modal" onclick="closeShop()">&times;</span>
        <h2>ğŸ›’ å•†åº— Â· æ ¡é—¨å£çš„è¶…å¸‚</h2>

        <!-- é¡¶éƒ¨ä½™é¢ -->
        <div class="shop-balance">ä½™é¢ï¼š<strong id="shop-cash">Â¥0</strong></div>

        <!-- åˆ†ç±»æ ‡ç­¾ -->
        <div class="shop-tabs" id="shop-tabs"></div>

        <!-- ç‰©å“åˆ—è¡¨ -->
        <div class="shop-grid" id="shop-list"></div>
      </div>
    </div>



    <!-- èƒŒåŒ…å¼¹çª— -->
    <div id="inventory-modal">
      <div class="inv-content">
        <span class="close-modal" onclick="closeInventory()">&times;</span>
        <h2>ğŸ’ æˆ‘çš„èƒŒåŒ…</h2>
        <div class="inv-summary">
          ç‰©å“ç§ç±»ï¼š<strong id="inv-kinds">0</strong>ï¼Œ
          æ€»æ•°é‡ï¼š<strong id="inv-total">0</strong>
        </div>

        <!-- åˆ†ç±»æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰ -->
        <div class="inv-tabs" id="inv-tabs"></div>

        <!-- ç‰©å“åˆ—è¡¨ -->
        <div class="inv-grid" id="inv-list"></div>

        <!-- ç©ºèƒŒåŒ…æç¤º -->
        <div class="inv-empty" id="inv-empty" style="display:none;">
          èƒŒåŒ…ç©ºç©ºå¦‚ä¹Ÿï¼Œå»<span class="inv-link" onclick="openShop()">å•†åº—</span>é€›é€›å§ï½
        </div>
      </div>
    </div>

    <!-- é€‰æ‹©ç¤¼ç‰©å¼¹çª— -->
    <div id="gift-modal" style="display:none;">
      <div class="gift-content">
        <span class="close-modal" onclick="closeGiftModal()">&times;</span>
        <h2>ğŸ é€‰æ‹©è¦é€çš„ç¤¼ç‰©</h2>
        <div class="gift-tip" id="gift-tip">åªæ˜¾ç¤ºèƒŒåŒ…ä¸­æ‹¥æœ‰çš„ç¤¼ç‰©</div>
        <div class="gift-grid" id="gift-list"></div>
        <div class="gift-empty" id="gift-empty" style="display:none;">
          èƒŒåŒ…é‡Œæ²¡æœ‰ç¤¼ç‰©å¯é€ã€‚å» <span class="gift-link" onclick="closeGiftModal(); openShop('gift');">å•†åº—</span> é€›é€›å§ï½
        </div>
      </div>
    </div>





    <script>
        // ===== æ¸¸æˆæ•°æ®ç»“æ„ =====
        const gameData = {
            personalities: [
                { name: "å‹¤å¥‹å‹", bonus: {memory: 10, engineering: 10} },
                { name: "å¤©æ‰å‹", bonus: {iq: 15, logic: 10} },
                { name: "ç¤¾äº¤å‹", bonus: {eq: 15, languages: 10} },
                { name: "è‰ºæœ¯å‹", bonus: {eq: 10, memory: 10} },
                { name: "å®è·µå‹", bonus: {logic: 10, engineering: 15} }
            ],
            
            subjects: {
                math: { name: "æ•°å­¦", depends: {iq: 0.5, logic: 0.5} },
                chinese: { name: "è¯­æ–‡", depends: {eq: 0.5, memory: 0.5} },
                english: { name: "è‹±è¯­", depends: {memory: 0.7, languages: 0.3} },
                physics: { name: "ç‰©ç†", depends: {logic: 1} },
                chemistry: { name: "åŒ–å­¦", depends: {engineering: 1} },
                biology: { name: "ç”Ÿç‰©", depends: {memory: 0.5, engineering: 0.5} },
                geography: { name: "åœ°ç†", depends: {iq: 0.5, memory: 0.5} },
                history: { name: "å†å²", depends: {logic: 0.5, memory: 0.5} },
                politics: { name: "æ”¿æ²»", depends: {eq: 0.5, logic: 0.5} },
                all_score: { name: "æ€»åˆ†", depends: {} }
            },
            
            seasons: ["æ˜¥å­£", "å¤å­£", "ç§‹å­£", "å†¬å­£"],
            // events : {},       
        };      

        // ===== å­¦ç”ŸçŠ¶æ€ =====
        let student = {
            name: "",
            age: 18,
            gender:0,
            seasonIndex: 0,
            personality: null,
            major: "", // "æ–‡ç§‘" or "ç†ç§‘"
            Highschool_Arts_and_Sciences :"",
            Student_level : Math.ceil(Math.random()*7),
            scores: {},
            completedEvents: {}, // è®°å½•å·²å®Œæˆäº‹ä»¶
            lastExamScores: null, // è®°å½•ä¸Šæ¬¡è€ƒè¯•æˆç»©
            roommate : null, // æ˜¯å¦æœ‰å®¤å‹
            family_eco : null, //å®¶åº­ç»æµæ°´å¹³
            seasonRandomEvents: [],   // æœ¬å­£åº¦å·²æŠ½å‡ºçš„éšæœºäº‹ä»¶ï¼ˆç¼“å­˜ï¼‰
            thisSeasonAppeared: [],   // æœ¬å­£åº¦å·²å‡ºç°çš„éšæœºäº‹ä»¶ idï¼ˆä»…ç”¨äºå»é‡ï¼‰
            thisSeasonCompleted: [],   // æœ¬å­£åº¦å·²å®Œæˆçš„äº‹ä»¶ idï¼ˆä»…å½“å‰å­£åº¦æœ‰æ•ˆï¼‰
            randomCount: 0,               // æœ¬å­£åº¦æŠ½äº†å‡ ä¸ªéšæœºäº‹ä»¶
            reports: [],  // æŠ¥å‘Šå†å²æ•°ç»„
            love: null, //æ˜¯å¦è°ˆæ‹çˆ±
            gaokaoScore: null, //æ˜¯å¦æœ‰é«˜è€ƒæˆç»©
            university: null, //æ˜¯å¦å·²ç»è¢«å¤§å­¦å½•å–
            work:null, //æ˜¯å¦å‚åŠ å·¥ä½œ
            cash:200,
            inventory:{}, //èƒŒåŒ…
            quarterActions : {
                npc:  {
                  "father":{chat:false, gift:false, study:true, tease:true},
                  "mother":{chat:false, gift:false, study:true, tease:true},
                  "teacher_gaosan":{chat:false, gift:false, study:true, tease:true},
                  "deskmate":{chat:false, gift:false, study:false, tease:false},
                  "friend_boy":{chat:false, gift:false, study:false, tease:false},
                  "friend_girl":{chat:false, gift:false, study:false, tease:false},
                  "love_friend_boy_1":{chat:false, gift:false, study:false, tease:false},
                  "love_friend_girl_1":{chat:false, gift:false, study:false, tease:false},
                  "roommate_1_a":{chat:false, gift:false, study:false, tease:false},
                  "roommate_1_b":{chat:false, gift:false, study:false, tease:false},
                  "roommate_1_c":{chat:false, gift:false, study:false, tease:false},
                  "roommate_2_a":{chat:false, gift:false, study:false, tease:false},
                  "roommate_2_b":{chat:false, gift:false, study:false, tease:false},
                  "roommate_2_c":{chat:false, gift:false, study:false, tease:false},
                  "senior_lab":{chat:false, gift:false, study:false, tease:false},
                  "counsellor":{chat:false, gift:false, study:false, tease:false},
                  "club_leader":{chat:false, gift:false, study:false, tease:false},
                  "class_beauty":{chat:false, gift:false, study:false, tease:false},
                  "class_handsome":{chat:false, gift:false, study:false, tease:false},
                  "pro_teacher":{chat:false, gift:false, study:false, tease:false},},   // å·²ä¸ NPC äº’åŠ¨è¿‡ï¼Ÿ
                game: false,   // å·²æ‰“æ¸¸æˆï¼Ÿ
                park: false,   // å·²å»å…¬å›­ï¼Ÿ
                show: false,    // å·²çœ‹å‰§ï¼Ÿ
                dating:false,  // å·²çº¦ä¼šï¼Ÿ
                self_learn:false, //å·²è‡ªä¸»å­¦ä¹ ï¼Ÿ
              }
        };  

        // ===== é«˜è€ƒå¿—æ„¿æ•°æ®åº“ï¼ˆåˆ†æ®µ < 50 åˆ†ï¼‰=====
        const GAOKAO_DB = [
          {min:700,max:749,
            reach:  ["æ¸…åå¤§å­¦","åŒ—äº¬å¤§å­¦"],
            target: ["æ¸…åå¤§å­¦","åŒ—äº¬å¤§å­¦"],
            safety: ["å¤æ—¦å¤§å­¦","ä¸Šæµ·äº¤é€šå¤§å­¦","æµ™æ±Ÿå¤§å­¦"]},
          {min:680,max:699,
            reach:  ["æ¸…åå¤§å­¦","åŒ—äº¬å¤§å­¦"],
            target: ["å¤æ—¦å¤§å­¦","ä¸Šæµ·äº¤é€šå¤§å­¦","æµ™æ±Ÿå¤§å­¦"],
            safety: ["ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦","å—äº¬å¤§å­¦","ä¸­å›½äººæ°‘å¤§å­¦"]},

          {min:660,max:679,
            reach:  ["å¤æ—¦å¤§å­¦","ä¸Šæµ·äº¤é€šå¤§å­¦","æµ™æ±Ÿå¤§å­¦"],
            target: ["ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦","å—äº¬å¤§å­¦","ä¸­å›½äººæ°‘å¤§å­¦","åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦","åŒæµå¤§å­¦"],
            safety: ["åŒ—äº¬ç†å·¥å¤§å­¦","åä¸­ç§‘æŠ€å¤§å­¦","å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦"]},

          {min:650,max:659,
            reach:  ["ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦","å—äº¬å¤§å­¦","ä¸­å›½äººæ°‘å¤§å­¦","åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦"],
            target: ["åŒæµå¤§å­¦","æµ™æ±Ÿå¤§å­¦ï¼ˆéƒ¨åˆ†ä¸“ä¸šï¼‰","ä¸­å±±å¤§å­¦","å—å¼€å¤§å­¦","æ­¦æ±‰å¤§å­¦","åŒ—äº¬ç†å·¥å¤§å­¦"],
            safety: ["åä¸­ç§‘æŠ€å¤§å­¦","è¥¿å®‰äº¤é€šå¤§å­¦","å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦","ç”µå­ç§‘æŠ€å¤§å­¦"]},

          {min:640,max:649,
            reach:  ["åŒæµå¤§å­¦","æµ™æ±Ÿå¤§å­¦ï¼ˆéƒ¨åˆ†ä¸“ä¸šï¼‰","ä¸­å±±å¤§å­¦","å—å¼€å¤§å­¦","æ­¦æ±‰å¤§å­¦","åŒ—äº¬ç†å·¥å¤§å­¦"],
            target: ["åä¸­ç§‘æŠ€å¤§å­¦","è¥¿å®‰äº¤é€šå¤§å­¦","å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦","ç”µå­ç§‘æŠ€å¤§å­¦","åŒ—äº¬ç†å·¥å¤§å­¦"],
            safety: ["åŒ—äº¬é‚®ç”µå¤§å­¦","ä¸œå—å¤§å­¦","å¤©æ´¥å¤§å­¦","å¦é—¨å¤§å­¦"]},

          {min:620,max:639,
            reach:  ["åä¸­ç§‘æŠ€å¤§å­¦","è¥¿å®‰äº¤é€šå¤§å­¦","å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦","ç”µå­ç§‘æŠ€å¤§å­¦"],
            target: ["ä¸œå—å¤§å­¦","å¤©æ´¥å¤§å­¦","å¦é—¨å¤§å­¦","åŒ—äº¬é‚®ç”µå¤§å­¦","ä¸­å›½å†œä¸šå¤§å­¦"],
            safety: ["åå—ç†å·¥å¤§å­¦","åä¸œç†å·¥å¤§å­¦","å±±ä¸œå¤§å­¦","å‰æ—å¤§å­¦"]},

          {min:600,max:619,
            reach:  ["ä¸œå—å¤§å­¦","å¤©æ´¥å¤§å­¦","å¦é—¨å¤§å­¦","åŒ—äº¬é‚®ç”µå¤§å­¦","ä¸­å›½å†œä¸šå¤§å­¦"],
            target: ["åå—ç†å·¥å¤§å­¦","åä¸œç†å·¥å¤§å­¦","å±±ä¸œå¤§å­¦","å‰æ—å¤§å­¦","è‹å·å¤§å­¦"],
            safety: ["åŒ—äº¬äº¤é€šå¤§å­¦","åŒ—äº¬ç§‘æŠ€å¤§å­¦","é‡åº†å¤§å­¦","å—äº¬èˆªç©ºèˆªå¤©å¤§å­¦"]},

          {min:580,max:599,
            reach:  ["åå—ç†å·¥å¤§å­¦","åä¸œç†å·¥å¤§å­¦","å±±ä¸œå¤§å­¦","å‰æ—å¤§å­¦"],
            target: ["åŒ—äº¬äº¤é€šå¤§å­¦","åŒ—äº¬ç§‘æŠ€å¤§å­¦","é‡åº†å¤§å­¦","å—äº¬èˆªç©ºèˆªå¤©å¤§å­¦","å—äº¬ç†å·¥å¤§å­¦"],
            safety: ["éƒ‘å·å¤§å­¦","æ¹–å—å¤§å­¦","åä¸­å¸ˆèŒƒå¤§å­¦","åä¸œå¸ˆèŒƒå¤§å­¦ï¼ˆéƒ¨åˆ†ï¼‰"]},

          {min:560,max:579,
            reach:  ["åŒ—äº¬äº¤é€šå¤§å­¦","åŒ—äº¬ç§‘æŠ€å¤§å­¦","é‡åº†å¤§å­¦","å—äº¬èˆªç©ºèˆªå¤©å¤§å­¦","å—äº¬ç†å·¥å¤§å­¦"],
            target: ["éƒ‘å·å¤§å­¦","æ¹–å—å¤§å­¦","åä¸­å¸ˆèŒƒå¤§å­¦","åä¸œå¸ˆèŒƒå¤§å­¦ï¼ˆéƒ¨åˆ†ï¼‰","æš¨å—å¤§å­¦"],
            safety: ["åŒ—äº¬å·¥å•†å¤§å­¦","ä¸Šæµ·å¤§å­¦","å¹¿ä¸œå·¥ä¸šå¤§å­¦","åŒ—äº¬æ—ä¸šå¤§å­¦"]},

          {min:540,max:559,
            reach:  ["éƒ‘å·å¤§å­¦","æ¹–å—å¤§å­¦","æš¨å—å¤§å­¦","åä¸­å¸ˆèŒƒå¤§å­¦"],
            target: ["ä¸Šæµ·å¤§å­¦","å¹¿ä¸œå·¥ä¸šå¤§å­¦","åŒ—äº¬æ—ä¸šå¤§å­¦","è¥¿åŒ—å·¥ä¸šå¤§å­¦ï¼ˆéƒ¨åˆ†ï¼‰","è¥¿å—äº¤é€šå¤§å­¦"],
            safety: ["å—äº¬ä¿¡æ¯å·¥ç¨‹å¤§å­¦","ç‡•å±±å¤§å­¦","ç¦å·å¤§å­¦","äº‘å—å¤§å­¦"]},

          {min:520,max:539,
            reach:  ["ä¸Šæµ·å¤§å­¦","å¹¿ä¸œå·¥ä¸šå¤§å­¦","åŒ—äº¬æ—ä¸šå¤§å­¦","è¥¿å—äº¤é€šå¤§å­¦"],
            target: ["å—äº¬ä¿¡æ¯å·¥ç¨‹å¤§å­¦","ç‡•å±±å¤§å­¦","ç¦å·å¤§å­¦","äº‘å—å¤§å­¦","åˆè‚¥å·¥ä¸šå¤§å­¦ï¼ˆéƒ¨åˆ†ï¼‰"],
            safety: ["æˆéƒ½ç†å·¥å¤§å­¦","ä¸Šæµ·ç†å·¥å¤§å­¦","åŒ—äº¬ä¿¡æ¯ç§‘æŠ€å¤§å­¦","é’å²›å¤§å­¦"]},

          {min:500,max:519,
            reach:  ["å—äº¬ä¿¡æ¯å·¥ç¨‹å¤§å­¦","ç‡•å±±å¤§å­¦","ç¦å·å¤§å­¦","äº‘å—å¤§å­¦"],
            target: ["ä¸Šæµ·ç†å·¥å¤§å­¦","åŒ—äº¬ä¿¡æ¯ç§‘æŠ€å¤§å­¦","é’å²›å¤§å­¦","æ­å·ç”µå­ç§‘æŠ€å¤§å­¦","æ·±åœ³å¤§å­¦ï¼ˆéƒ¨åˆ†ï¼‰"],
            safety: ["å—æ˜Œå¤§å­¦","æ²³åŒ—å¤§å­¦","è¥¿å—å¤§å­¦","è´µå·å¤§å­¦"]},

          {min:480,max:499,
            reach:  ["ä¸Šæµ·ç†å·¥å¤§å­¦","åŒ—äº¬ä¿¡æ¯ç§‘æŠ€å¤§å­¦","é’å²›å¤§å­¦","æ­å·ç”µå­ç§‘æŠ€å¤§å­¦","å—æ˜Œå¤§å­¦"],
            target: ["æ²³åŒ—å¤§å­¦","è¥¿å—å¤§å­¦","è´µå·å¤§å­¦","å¹¿è¥¿å¤§å­¦","æ²³å—å¤§å­¦"],
            safety: ["å¹¿ä¸œè´¢ç»å¤§å­¦","æµ™æ±Ÿå·¥ä¸šå¤§å­¦","å—äº¬å·¥ä¸šå¤§å­¦","ä¸Šæµ·å·¥ç¨‹æŠ€æœ¯å¤§å­¦"]},

          {min:460,max:479,
            reach:  ["æ²³åŒ—å¤§å­¦","è¥¿å—å¤§å­¦","è´µå·å¤§å­¦","å¹¿è¥¿å¤§å­¦","æ²³å—å¤§å­¦"],
            target: ["æµ™æ±Ÿå·¥ä¸šå¤§å­¦","å—äº¬å·¥ä¸šå¤§å­¦","ä¸Šæµ·å·¥ç¨‹æŠ€æœ¯å¤§å­¦","æµ™æ±Ÿç†å·¥å¤§å­¦","ä¸œåå¤§å­¦ï¼ˆéƒ¨åˆ†ï¼‰"],
            safety: ["å¹¿ä¸œæµ·æ´‹å¤§å­¦","ä¸‰å³¡å¤§å­¦","å±±ä¸œç§‘æŠ€å¤§å­¦","ä¸­åŒ—å¤§å­¦"]},

          {min:440,max:459,
            reach:  ["æµ™æ±Ÿå·¥ä¸šå¤§å­¦","å—äº¬å·¥ä¸šå¤§å­¦","ä¸Šæµ·å·¥ç¨‹æŠ€æœ¯å¤§å­¦","æµ™æ±Ÿç†å·¥å¤§å­¦"],
            target: ["å±±ä¸œç§‘æŠ€å¤§å­¦","ä¸­åŒ—å¤§å­¦","å¹¿ä¸œæµ·æ´‹å¤§å­¦","ä¸‰å³¡å¤§å­¦","é‡åº†ç†å·¥å¤§å­¦"],
            safety: ["æ¹–å—å·¥ä¸šå¤§å­¦","æ±Ÿè¥¿ç†å·¥å¤§å­¦","å¹¿è¥¿å¸ˆèŒƒå¤§å­¦","è¥¿åå¤§å­¦"]},

          {min:420,max:439,
            reach:  ["å±±ä¸œç§‘æŠ€å¤§å­¦","ä¸­åŒ—å¤§å­¦","é‡åº†ç†å·¥å¤§å­¦","å¹¿ä¸œæµ·æ´‹å¤§å­¦"],
            target: ["æ¹–å—å·¥ä¸šå¤§å­¦","æ±Ÿè¥¿ç†å·¥å¤§å­¦","å¹¿è¥¿å¸ˆèŒƒå¤§å­¦","è¥¿åå¤§å­¦","å®‰å¾½å·¥ç¨‹å¤§å­¦"],
            safety: ["æ²³åŒ—å·¥ç¨‹å¤§å­¦","æ²ˆé˜³å·¥ä¸šå¤§å­¦","å—äº¬å·¥ç¨‹å­¦é™¢","æ±Ÿè‹ç§‘æŠ€å¤§å­¦"]},

          {min:400,max:419,
            reach:  ["æ¹–å—å·¥ä¸šå¤§å­¦","æ±Ÿè¥¿ç†å·¥å¤§å­¦","å¹¿è¥¿å¸ˆèŒƒå¤§å­¦","è¥¿åå¤§å­¦"],
            target: ["æ²³åŒ—å·¥ç¨‹å¤§å­¦","æ²ˆé˜³å·¥ä¸šå¤§å­¦","å—äº¬å·¥ç¨‹å­¦é™¢","æ±Ÿè‹ç§‘æŠ€å¤§å­¦","æ¹–åŒ—å·¥ä¸šå¤§å­¦"],
            safety: ["æ¸©å·å¤§å­¦","å¹¿ä¸œæŠ€æœ¯å¸ˆèŒƒå¤§å­¦","å“ˆå°”æ»¨ç†å·¥å¤§å­¦","å¤ªåŸç§‘æŠ€å¤§å­¦"]},

          {min:380,max:399,
            reach:  ["æ²³åŒ—å·¥ç¨‹å¤§å­¦","æ²ˆé˜³å·¥ä¸šå¤§å­¦","æ±Ÿè‹ç§‘æŠ€å¤§å­¦","æ¹–åŒ—å·¥ä¸šå¤§å­¦"],
            target: ["æ¸©å·å¤§å­¦","å¹¿ä¸œæŠ€æœ¯å¸ˆèŒƒå¤§å­¦","å“ˆå°”æ»¨ç†å·¥å¤§å­¦","å¤ªåŸç§‘æŠ€å¤§å­¦","é‡åº†å·¥å•†å¤§å­¦"],
            safety: ["è†ç”°å­¦é™¢","æ³‰å·å¸ˆèŒƒå­¦é™¢","é»”å—æ°‘æ—å¸ˆèŒƒå­¦é™¢","æ¸¤æµ·å¤§å­¦"]},

          {min:360,max:379,
            reach:  ["æ¸©å·å¤§å­¦","å¹¿ä¸œæŠ€æœ¯å¸ˆèŒƒå¤§å­¦","å“ˆå°”æ»¨ç†å·¥å¤§å­¦","å¤ªåŸç§‘æŠ€å¤§å­¦"],
            target: ["æ¸¤æµ·å¤§å­¦","é‡åº†å·¥å•†å¤§å­¦","è¾½å®ç§‘æŠ€å¤§å­¦","é•¿æ²™å­¦é™¢","æ´›é˜³ç†å·¥å­¦é™¢"],
            safety: ["Ã—Ã—èŒä¸šæŠ€æœ¯å­¦é™¢ï¼ˆè®¡ç®—æœº/æœºç”µç±»ï¼‰","Ã—Ã—èŒä¸šæŠ€æœ¯å­¦é™¢ï¼ˆå¤§æ•°æ®/æŠ¤ç†ç±»ï¼‰"]},

          {min:340,max:359,
            reach:  ["æ¸¤æµ·å¤§å­¦","é‡åº†å·¥å•†å¤§å­¦","è¾½å®ç§‘æŠ€å¤§å­¦","æ´›é˜³ç†å·¥å­¦é™¢"],
            target: ["åœ°æ–¹æœ¬ç§‘é™¢æ ¡ï¼ˆåº”ç”¨å‹ï¼‰","æ°‘åŠæœ¬ç§‘ï¼ˆä¿¡æ¯ç®¡ç†/ç”µå•†ï¼‰","ç‹¬ç«‹å­¦é™¢ï¼ˆå·¥ç®¡/ä¼šè®¡ï¼‰"],
            safety: ["é«˜èŒä¸“ç§‘ï¼ˆè½¯ä»¶/æŠ¤ç†/æ–°åª’ä½“ï¼‰","é«˜èŒä¸“ç§‘ï¼ˆæ•°æ§/æ±½ä¿®/ç‰©è”ç½‘ï¼‰"]},

          {min:320,max:339,
            reach:  ["åœ°æ–¹æœ¬ç§‘ï¼ˆåº”ç”¨å‹ï¼‰","ç‹¬ç«‹å­¦é™¢ï¼ˆå·¥ç§‘/ç®¡ç†ï¼‰"],
            target: ["æ°‘åŠæœ¬ç§‘ï¼ˆè®¡ç§‘/è´¢åŠ¡/ç‰©æµï¼‰","é«˜èŒä¸“ç§‘ï¼ˆè®¡ç®—æœº/æŠ¤èˆªï¼‰"],
            safety: ["é«˜èŒä¸“ç§‘ï¼ˆçƒ­é—¨å¤§ç±»ï¼‰","ä¸­å¤–åˆä½œï¼ˆä¸“å‡æœ¬é€šé“ï¼‰"]},

          {min:300,max:319,
            reach:  ["æ°‘åŠæœ¬ç§‘ï¼ˆå°‘æ•°ä¸“ä¸šï¼‰","ä¸“å‡æœ¬è§„åˆ’å‹è·¯å¾„"],
            target: ["é«˜èŒä¸“ç§‘ï¼ˆçƒ­é—¨ï¼šè®¡ç§‘/æŠ¤ç†/æ–°åª’ä½“ï¼‰"],
            safety: ["é«˜èŒä¸“ç§‘ï¼ˆåœ°æ–¹çƒ­é—¨é«˜å°±ç‡é™¢æ ¡ï¼‰"]},

          {min:280,max:299,
            reach:  ["é«˜èŒä¸“ç§‘ï¼ˆä¼˜åŠ¿ä¸“ä¸šï¼‰"],
            target: ["é«˜èŒä¸“ç§‘ï¼ˆæœ¬çœçƒ­é—¨ï¼‰"],
            safety: ["é«˜èŒä¸“ç§‘ï¼ˆåŸå¸‚å°±ä¸šèµ„æºå¥½ï¼‰"]},

          {min:260,max:279,
            reach:  ["é«˜èŒä¸“ç§‘ï¼ˆçƒ­é—¨ï¼‰"],
            target: ["é«˜èŒä¸“ç§‘ï¼ˆæ™®é€šï¼‰"],
            safety: ["é«˜èŒä¸“ç§‘ï¼ˆå¯¹å£ä¸­é«˜èŒè¡”æ¥ï¼‰"]},
        ];

        // ===== ä¸“ä¸šåº“ï¼ˆæ–‡/ç†åˆ†æµï¼‰=====
        const MAJOR_DB = {
          "æ–‡ç§‘": [
            "æ±‰è¯­è¨€æ–‡å­¦","å†å²å­¦","å“²å­¦","æ³•å­¦","ç¤¾ä¼šå­¦","æ”¿æ²»å­¦ä¸è¡Œæ”¿å­¦","å›½é™…å…³ç³»",
            "æ–°é—»å­¦","ä¼ æ’­å­¦","å¹¿å‘Šå­¦","è¡Œæ”¿ç®¡ç†","å…¬å…±äº‹ä¸šç®¡ç†","äººåŠ›èµ„æºç®¡ç†",
            "æ•™è‚²å­¦","å­¦å‰æ•™è‚²","å¿ƒç†å­¦ï¼ˆæ–‡ï¼‰","å¤–å›½è¯­è¨€æ–‡å­¦","ç¿»è¯‘","å•†åŠ¡è‹±è¯­",
            "ç»æµå­¦ï¼ˆæ–‡ï¼‰","è´¢æ”¿å­¦ï¼ˆæ–‡ï¼‰","å›½é™…ç»æµä¸è´¸æ˜“ï¼ˆæ–‡ï¼‰","é‡‘èå­¦ï¼ˆæ–‡ï¼‰",
            "ä¼šè®¡å­¦ï¼ˆæ–‡ï¼‰","å¸‚åœºè¥é”€","å›¾ä¹¦æƒ…æŠ¥ä¸æ¡£æ¡ˆç®¡ç†","æ–‡åŒ–äº§ä¸šç®¡ç†","è‰ºæœ¯ç®¡ç†",
            "æ±‰è¯­å›½é™…æ•™è‚²","è€ƒå¤å­¦"
          ],
          "ç†ç§‘": [
            "è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯","è½¯ä»¶å·¥ç¨‹","äººå·¥æ™ºèƒ½","æ•°æ®ç§‘å­¦ä¸å¤§æ•°æ®æŠ€æœ¯",
            "ä¿¡æ¯å®‰å…¨","ç½‘ç»œå·¥ç¨‹","ç”µå­ä¿¡æ¯å·¥ç¨‹","ç”µå­ç§‘å­¦ä¸æŠ€æœ¯","å¾®ç”µå­ç§‘å­¦ä¸å·¥ç¨‹",
            "è‡ªåŠ¨åŒ–","é€šä¿¡å·¥ç¨‹","æµ‹æ§æŠ€æœ¯ä¸ä»ªå™¨","ç”µæ°”å·¥ç¨‹åŠå…¶è‡ªåŠ¨åŒ–",
            "æœºæ¢°å·¥ç¨‹","è½¦è¾†å·¥ç¨‹","ææ–™ç§‘å­¦ä¸å·¥ç¨‹","åœŸæœ¨å·¥ç¨‹","ç¯å¢ƒå·¥ç¨‹",
            "åŒ–å­¦å·¥ç¨‹ä¸å·¥è‰º","ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹","ç”Ÿç‰©ç§‘å­¦","ç”Ÿç‰©æŠ€æœ¯","ä¸´åºŠåŒ»å­¦",
            "è¯å­¦","æ•°å­¦ä¸åº”ç”¨æ•°å­¦","ç»Ÿè®¡å­¦","ç‰©ç†å­¦","åœ°ç†ä¿¡æ¯ç§‘å­¦",
            "èˆªç©ºèˆªå¤©å·¥ç¨‹","èƒ½æºä¸åŠ¨åŠ›å·¥ç¨‹","èˆ¹èˆ¶ä¸æµ·æ´‹å·¥ç¨‹","å†œå­¦"
          ]
        };

        // åˆ†ç±»å¸¸é‡ï¼ˆæ˜¾ç¤ºé¡ºåºï¼‰
        const SHOP_CATEGORIES = [
          { key: "gift",   name: "ç¤¼ç‰©ç±»" },
          { key: "daily",  name: "æ—¥å¸¸ç±»" },
          { key: "study",  name: "å­¦ä¹ ç±»" },
          //{ key: "med",    name: "è¯å“ç±»" },
          { key: "event",  name: "äº‹ä»¶ç‰©å“" },
        ];

        const INV_CATEGORIES = [
          { key:"all",  name:"å…¨éƒ¨" },
          { key:"gift",  name:"ç¤¼ç‰©ç±»" },
          { key:"daily", name:"æ—¥å¸¸ç±»" },
          { key:"study", name:"å­¦ä¹ ç±»" },
          { key:"event", name:"äº‹ä»¶ç‰©å“" },
          { key:"special", name:"ç‰¹æ®Šç‰©å“" }, 
        ];


        // å•†å“åº“ï¼ˆid å¿…é¡»å”¯ä¸€ï¼›stockLeft/stockTotal åº“å­˜ï¼›img ä¸ºç›¸å¯¹è·¯å¾„ï¼‰
        const SHOP_DB = [
          // ç¤¼ç‰©ç±»
          { id:"gift_flower", cat:"gift", purchasable: true, name:"å‘æ—¥è‘µèŠ±æŸ", desc:"å‘é˜³è€Œç”Ÿï¼Œé€ä½ æ˜æœ—æ´»åŠ›ï½", price: 50, stockLeft: 20,favor:2, stockTotal: 20, img:"./pic/shops/sunflower.png" },
          { id:"gift_choco",  cat:"gift", purchasable: true, name:"æ‰‹å·¥å·§å…‹åŠ›", desc:"æ‰‹ä½œç”œæ„ï¼Œè—ç€ä¸“å±å¿ƒæ„ï½", price: 80, stockLeft: 20,favor:5, stockTotal: 20, img:"./pic/shops/chocolate.png" },
          { id:"gift_choco",  cat:"gift", purchasable: true, name:"ä¿æ¸©æ¯ç¤¼ç›’", desc:"æ’æ¸©é™ªä¼´ï¼Œæ—¥å¸¸è´´å¿ƒå®ˆæŠ¤ï½", price: 280, stockLeft: 20,favor:9, stockTotal: 20, img:"./pic/shops/thermos_cup.png" },
          { id:"gift_choco",  cat:"gift", purchasable: true, name:"è‹¹æœæ— çº¿è€³æœº", desc:"è½»å·§éŸ³è´¨ï¼Œæ‰¿åŒ…æ ¡å›­æ—¶å…‰ï½", price: 800, stockLeft: 20,favor:20, stockTotal: 20, img:"./pic/shops/airpods.png" },
          // æ—¥å¸¸ç±»
          { id:"daily_water", cat:"daily", purchasable: true, name:"çŸ¿æ³‰æ°´", desc:"è¡¥å……æ°´åˆ†ï¼Œå¥åº·ç•¥æœ‰æ¢å¤ã€‚", price: 3, stockLeft: 10, stockTotal: 10, img:"" },
          { id:"med_vit",     cat:"daily", purchasable: true, name:"å¤åˆç»´ç”Ÿç´ ", desc:"ç¼“è§£ç–²åŠ³ï¼Œå¥åº·+5ã€‚", price: 22, stockLeft: 4, stockTotal: 4, img:"" },
          { id:"med_cough",   cat:"daily", purchasable: true, name:"æ­¢å’³ç³–æµ†", desc:"å–‰å’™ä¸é€‚æ—¶çš„æ•‘æ˜Ÿã€‚", price: 18, stockLeft: 2, stockTotal: 2, img:"" },
          // å­¦ä¹ ç±»
          { id:"study_paper", cat:"study", purchasable: true, name:"A4 çº¸", desc:"æ‰“å°ææ–™ã€æ•´ç†ç¬”è®°å¿…å¤‡ã€‚", price: 5, stockLeft: 6, stockTotal: 6, img:"" },
          { id:"study_pen",   cat:"study", purchasable: true, name:"ç­¾å­—ç¬”", desc:"ä¹¦å†™æ›´é¡ºæ»‘ï¼Œå­¦ä¹ æ•ˆç‡ç•¥å¢ã€‚", price: 8, stockLeft: 5, stockTotal: 5, img:"" },
          // äº‹ä»¶ç‰©å“ç±»ï¼ˆç¤ºä¾‹ï¼šè§¦å‘äº‹ä»¶/è§£é”å‰§æƒ…ï¼‰
          { id:"event_ticket",cat:"event", purchasable: true, name:"æ ¡å›­æ¼”å‡ºé—¨ç¥¨", desc:"å¯è§¦å‘ä¸€æ¬¡ã€çœ‹å‰§ã€‘ç‰¹åˆ«äº‹ä»¶ã€‚", price: 40, stockLeft: 2, stockTotal: 2, img:"" },
          { id:"event_giftbox",cat:"event", purchasable: true, name:"ç¥ç§˜ç¤¼ç›’", desc:"éšæœºæƒŠå–œæˆ–å°æ’æ›²ã€‚", price: 66, stockLeft: 1, stockTotal: 1, img:"" },
        ];

        const ITEM_DB = [
          // â€”â€” äº‹ä»¶ä¸“å± / å…³é”®é“å…·ï¼ˆä¸åœ¨å•†åº—å‡ºå”®ï¼‰â€”â€”
          { id: "campus_card", name: "æ ¡å›­å¡", cat: "special", price: null, purchasable: false, img: "./pic/shops/school_card.png", desc: "ç”¨äºå›¾ä¹¦é¦†/é£Ÿå ‚/é—¨ç¦çš„æ ¡å›­èº«ä»½å¡" },
          { id: "dorm_key", name: "å®¿èˆé’¥åŒ™", cat: "special", price: null, purchasable: false, img: "./pic/shops/dormitory_key.png", desc: "å®¿èˆé’¥åŒ™ï¼Œå¦¥å–„ä¿ç®¡" },
        ];






        // ==========ä¸»å‡½æ•°å¼€å§‹==========
        // ===== åœ¨è„šæœ¬é¡¶éƒ¨æ·»åŠ å…¨å±€å˜é‡ =====
        let currentOpenEvent = null; // å­˜å‚¨å½“å‰æ‰“å¼€çš„äº‹ä»¶
        let currentContinueStory = null;
        // å¯åŠ¨æ¸¸æˆ
        initGame();
        /* ========== NPC æ•°æ®åº“ï¼ˆç¤ºä¾‹ï¼‰ ========== */
                const NPC_DB = [
                  // alwaysKnown = åˆå§‹è®¤è¯†ï¼›condition å¯ç”¨äºâ€œè®¤è¯†æ¡ä»¶â€ï¼ˆå±æ€§ã€äº‹ä»¶ç­‰ï¼‰
                  { id:"father",  name:"çˆ¸çˆ¸", role:"çˆ¸çˆ¸", age:25+student.age, alwaysKnown:true,  favor:100, avatarUrl:"./pic/npc/father.png" },
                  { id:"mother",  name:"å¦ˆå¦ˆ", role:"å¦ˆå¦ˆ", age:24+student.age, alwaysKnown:true,  favor:100, avatarUrl:"./pic/npc/mother.png" },
                  { id:"deskmate",        name:"å‘¨äº‘å³°",   role:"é«˜ä¸­åŒæ¡Œ",     age:student.age, alwaysKnown:true,  favor:55, avatarUrl:"./pic/npc/deskmate.png" },
                  { id:"friend_boy",      name:"èµµå°ç£Š",   role:"é«˜ä¸­å¥½æœ‹å‹",     age:student.age, alwaysKnown:false,  favor:75, condition:()=> student.gender==1, avatarUrl:"./pic/npc/friend_boy.png" },
                  { id:"friend_girl",      name:"å´æ™“é›¯",   role:"é«˜ä¸­å¥½æœ‹å‹",     age:student.age, alwaysKnown:false,  favor:75, condition:()=> student.gender==0, avatarUrl:"./pic/npc/friend_girl.png" },
                  { id:"love_friend_boy_1",name:"å¼ æ›¼",   role:"åˆæ‹",     age:student.age, alwaysKnown:false,  favor:80, condition:()=> (student.love==1) && (student.gender==1), avatarUrl:"./pic/npc/love_friend_boy_1.png" },
                  { id:"love_friend_girl_1",name:"é­é¹",   role:"åˆæ‹",     age:student.age, alwaysKnown:false,  favor:80, condition:()=> (student.love==1) && (student.gender==0), avatarUrl:"./pic/npc/love_friend_girl_1.png" },
                  { id:"roommate_1_a",      name:"é»„å¼º",   role:"æœ¬ç§‘å®¤å‹A",      age:student.age, alwaysKnown:false, favor:40, condition:()=> (student.roommate)&&(student.gender==1), avatarUrl:"./pic/npc/roommate_1_a.png" },
                  { id:"roommate_1_b",      name:"åˆ˜å…æ–°",   role:"æœ¬ç§‘å®¤å‹B",      age:student.age, alwaysKnown:false, favor:60, condition:()=> (student.roommate)&&(student.gender==1), avatarUrl:"./pic/npc/roommate_1_b.png" },
                  { id:"roommate_1_c",      name:"æ¨å®‡",   role:"æœ¬ç§‘å®¤å‹C",      age:student.age, alwaysKnown:false, favor:20, condition:()=> (student.roommate)&&(student.gender==1), avatarUrl:"./pic/npc/roommate_1_c.png" },
                  { id:"roommate_2_a",      name:"é»„å¸†å¸†",   role:"æœ¬ç§‘å®¤å‹A",      age:student.age, alwaysKnown:false, favor:40, condition:()=> (student.roommate)&&(student.gender==0), avatarUrl:"./pic/npc/roommate_2_a.png" },
                  { id:"roommate_2_b",      name:"ç‹ä¸€å®",   role:"æœ¬ç§‘å®¤å‹B",      age:student.age, alwaysKnown:false, favor:60, condition:()=> (student.roommate)&&(student.gender==0), avatarUrl:"./pic/npc/roommate_2_b.png" },
                  { id:"roommate_2_c",      name:"å®‹æ•",   role:"æœ¬ç§‘å®¤å‹C",      age:student.age, alwaysKnown:false, favor:20, condition:()=> (student.roommate)&&(student.gender==0), avatarUrl:"" },
                  { id:"senior_lab",      name:"æ—è€€å­¦é•¿",   role:"å®éªŒå®¤å¸ˆå…„", age:2+student.age, alwaysKnown:false, favor:30, condition:()=> student.finalUniversity!=null, avatarUrl:"./pic/npc/roommate_2_c.png" },
                  { id:"counsellor",      name:"é™ˆéš†è¾…å¯¼å‘˜", role:"è¾…å¯¼å‘˜",     age:8+student.age, alwaysKnown:false, favor:35, condition:()=> student.age>=19, avatarUrl:"" },
                  { id:"club_leader",     name:"ææŒ¯",   role:"ç¤¾å›¢éƒ¨é•¿",   age:1+student.age, alwaysKnown:false, favor:30, condition:()=> (student.age>=19)&&(student.attributes.charm>=50), avatarUrl:"" },
                  { id:"class_beauty",    name:"ä¸¥æ™“äºˆ",   role:"é«˜ä¸­æ–‡è‰ºå§”å‘˜,ç­èŠ±",   age:student.age, alwaysKnown:false, favor:45, condition:()=> (student.attributes.charm>=60)&&(student.gender==1), avatarUrl:"./pic/npc/class_beauty.png" },
                  { id:"class_handsome",    name:"é«˜æ™¨åµ©",   role:"é«˜ä¸­ä½“è‚²å§”å‘˜,ç­è‰",   age:student.age, alwaysKnown:false, favor:45, condition:()=> (student.attributes.charm>=60)&&(student.gender==0), avatarUrl:"./pic/npc/class_handsome.png" },
                  { id:"teacher_gaosan",  name:"æè€å¸ˆ", role:"é«˜ä¸­ç­ä¸»ä»»", age:22+student.age, alwaysKnown:true,  favor:60, avatarUrl:"./pic/npc/teacher_gaosan.png" },
                  { id:"pro_teacher",     name:"ç‹æ•™æˆ", role:"å¯¼å¸ˆ",       age:30+student.age, alwaysKnown:false, favor:20, condition:()=> student.age>=22 && student.finalUniversity, avatarUrl:"" },
                ];

                // /* åˆå§‹å·²è®¤è¯†/å¥½æ„Ÿä¿å­˜ä½ï¼ˆåœ¨ initGame() é‡Œç¡®ä¿å­˜åœ¨ï¼‰ */
                if (!window.socialState) window.socialState = { known: {}, favor: {} };              
                
    </script>
</body>
</html>